<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        function FileFinder()
{
            var Path, foundFiles, aFile, Path, attr, i, e, dyear;
            var DateVal, Handle, FileDate, ReadOnlyFile;
            
            Path = "/Users/haoyin/Documents/BCS/Sem 6/Artificial-Intelligence_CSC3206/Assignment 2/system/assets/images/recommendation"; //Folder where we will search for files
            foundFiles=aqFileSystem.FindFiles(Path, "*.*");
            
            if (!strictEqual(foundFiles, null))
            while (foundFiles.HasNext())
                {
                aFile=foundFiles.Next();
                Log.Message("Processing the file " + Path + aFile.Name);
                
                // Checks whether the file date is earlier than 01/01/2004
                FileDate = aqFile.GetLastWriteTime(Path + aFile.Name); // Obtains the file date
                dyear = aqDateTime.GetYear(FileDate); // Gets the year
                if (dyear < 2004)
                {
                    // Changes the file date
                    DateVal = aqConvert.StrToDateTime("1/1/2004 00:01:00"); // New date & time

                    // Checks whether the file is read-only
                    ReadOnlyFile = (aFile.Attributes & 1) != 0;
                    // If the file is read-only, we should make it writable.
                    // Else, the file date cannot be changed.
                    if (ReadOnlyFile)
                    {
                    // Removes the ReadOnly attribute
                    attr = aFile.Attributes & (~1);
                    aqFile.SetFileAttributes(Path + aFile.Name, attr);
                    };
                
                    // Changes the file date
                    e = aqFile.SetLastWriteTime(Path + aFile.Name, DateVal);
                    // Reports whether the change was performed successfully
                    if (e)
                    Log.Message ("File date was changed successfully!");
                    else 
                    Log.Warning ("File date was not changed. Error: " + SysErrorMessage(e));
                    
                    // Restores the ReadOnly attribute, if necessary
                    if (ReadOnlyFile)
                    aqFile.SetFileAttributes(Path + aFile.Name, 1);
                };
                }
            else Log.Message("No files were found.");
            }
    </script>
</body>
</html>